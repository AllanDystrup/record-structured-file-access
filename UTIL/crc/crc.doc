




Tue Feb 17 16:51:14 CET 2026
CCITT CRC (REVERSE) for    crc.h   is	[BE97]





######  #######  #####
#     # #     # #     #
#     # #     # #
#     # #     # #
#     # #     # #
#     # #     # #     #
######  #######  #####



 #####   #####   #####

 #####   #####   #####









  ####   #####    ####           #    #
 #    #  #    #  #    #          #    #
 #       #    #  #               ######
 #       #####   #        ###    #    #
 #    #  #   #   #    #   ###    #    #
  ####   #    #   ####    ###    #    #






/*+1========================================================================*/
/* MODULE                          CRC.H                                    */
/*==========================================================================*/
/* FUNCTION    Headerfile for CRC.C
 *             To be included for access to function wCCITTcrc()
 *             for computing CCITT CRC-16 checksums of data in ram or on disk.
 * SEE ALSO    Documentation for file CRC.C
 * PROGRAMMER  Allan Dystrup
 * COPYRIGHT   (c) Allan Dystrup, Sept.1991
 * VERSION     $Header: d:/cwork/chb/ux/RCS/crc.h
 *             1.1 91/09/23 11:28:41 Allan_Dystrup Exp $
 *             $Log:	crc.h $
 *             Revision 1.1  91/09/23  11:28:41  Allan_Dystrup
 *             Initial revision
 *-1========================================================================*/Tue Feb 17 16:51:14 CET 2026
CCITT CRC (REVERSE) for    crc.h   is	[BE97]






END EXTRACTION






Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]





######  #######  #####
#     # #     # #     #
#     # #     # #
#     # #     # #
#     # #     # #
#     # #     # #     #
######  #######  #####



 #####   #####   #####

 #####   #####   #####









  ####   #####    ####            ####
 #    #  #    #  #    #          #    #
 #       #    #  #               #
 #       #####   #        ###    #
 #    #  #   #   #    #   ###    #    #
  ####   #    #   ####    ###     ####






/*+1========================================================================*/
/* MODULE                          CRC.C                                    */
/*==========================================================================*/
/* FUNCTION    Compute CCITT-CRC-16 checksum "on-the-fly".
 *                  The module contains a function : wCCITTcrc() for computing
 *             the checksum of a block of data.  The function may be compiled
 *             to a standard subroutine, which may then be called from another
 *             module (#include headerfile crc.h).  Alternatively the module
 *             crc.c can compile to a "standalone" program (compiler switch
 *             -DMAIN) for calculating checksums of arbitrary files.
 *                  wCCITTcrc() computes a "Cyclic Redundancy Check", using
 *             the CCITT polynomial as "generator".  The error detection rate
 *             is guaranteed to be 99.9984%, worst case.  The checksum utility
 *             may be used to verify the integrity of any block of data in
 *             memory or on disk (file validation).
 *
 * SYSTEM      STANDARD C.
 *             Tested on UNIX V.3 and PC/MS DOS 3.3
 *
 * PROGRAMMER  Allan Dystrup
 *
 * COPYRIGHT   (c) Allan Dystrup, Sept.1991
 *
 * VERSION     $Header: d:/cwork/chb/ux/RCS/crc.c 1.1
 *             91/09/19 23:18:30 Allan_Dystrup Exp $
 *             ---------------------------------------------------------------
 *             $Log:	crc.c $
 * 			Revision 1.1  91/09/23  11:31:20  Allan_Dystrup
 * 			Initial revision
 *
 * REFERENCES  Theory : Schwaderer, W.D. [1988]
 *                "C Programmer's guide to NetBIOS"
 *                Howard W. Sams & Company.
 *             Implementation: Several sources, notably credit to :
 *                Joe Campbell, Bob Felice, Nigel Cort,
 *                William Hunt & Andrew Chalk, PhD.

 * USAGE       1. as a standard subroutine :
 *                   #include <crc.h>
 *                   char *pzData = "Data for validation"; // data buffer
 *                   WORD wLength = strlen(pzData);        // length of buffer
 *                   WORD crc = PRESET;                    // initial crc preset
 *                   crc = wCCITTcrc(*pzData, wLength, crc);
 *             2. as a standalone program :
 *                   crc <filename> [optional tracelevel]

 * BUGS        1. Works only in a STANDARD C environment
 *                (Will not compile under K&R C without some massaging)
 *             2. On-the-fly crc calculation is relativevely slow, -
 *                might be speeded up by a table look-up approach.
 *                (This is primarily a demo-program).
 *
 *-1========================================================================*/Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]

/*+1 MODULE CRC.C ==========================================================*/
/*   NAME                          main                                     */
/*== SYNOPSIS ==============================================================*/
void
main(int argc,			       /* Argument count */
     char *argv[]		       /* Argument vector */
)
{
/* DESCRIPTION
 *    This main function may act as both a testdriver for module CRC.C and as
 *    a small application program for calculating file checksums.
 *    1    If MAIN is not defined, the module compiles function wCCITTcrc to
 *         a "standard subroutine", which may be accessed by including the
 *         the headerfile crc.h in your application module.
 *    2    If MAIN is defined (compiler flag -DMAIN), the module compiles to
 *         2.1   If NDEBUG is not defined : a testdriver for module CRC.C
 *         2.2   If NDEBUG is defined (compiler flag -DNDEBUG) : a standalone
 *               application for computing file checksums.
 *-1*/Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]

/*+2 MODULE ================================================================*/
/*   NAME                      wCCITTcrc                                    */
/*== SYNOPSIS ==============================================================*/
PUBLIC    WORD
wCCITTcrc(BYTE * pszData,      /* Pointer to databuffer */
	  DWORD dwLength,       /* Length of databuffer */
	  WORD wCrc             /* Current value of crc, to be updated */
)
{
/* DESCRIPTION
 *    This routine generates the 16-bit remainder of a block of data,
 *    using the 16-bit CCITT polynomial generator.  The basic idea is to
 *    treat the entire message as a (rather long) binary number; the crc
 *    checksum is then obtained by taking the one's complement of the
 *    remainder after the modulo 2 division by a generator polynomial.
 *                           16   12   5
 *    The CCITT-CRC uses: ( X  + X  + X + 1 ) for the generator polynomial.
 *    This may also be expressed as :
 *         bit position     16   12        5     0
 *       - in binary :       1 0001 0000 0010 0001
 *       - in hex    :       1    1    0    2    1
 *    In computing the crc, a 17-bit dataregister is simulated by testing
 *    the MostSignificantBit before shifting the data.  This affords us the
 *    luxury of specifying the polynomial as a 16-bit value : 0x1021.
 *    The crc is generated in "LSB->MSB" order, so the bits of the polynomial
 *    are also stored in reverse order : POLY = 0x8408.
 *-2*/Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]

/*+3 MODULE ----------------------------------------------------------------*/
/*   NAME                      wPOSTSETcrc                                  */
/*-- SYNOPSIS --------------------------------------------------------------*/
PRIVATE   WORD
wPOSTSETcrc(WORD wCrc)        /* Crc value to be "post-conditioned" */
{
/* DESCRIPTION
 *    CRC postconditioning  :  Do 1's complement and swap bytes in wCrc.
 *    When a crc is itself included in the calculation, the valid crc is :
 *    Final wCrc:0xF0B8, After complement:0x0F47, After byte swap:0x470F
 *-3*/Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]

/*+3 MODULE ----------------------------------------------------------------*/
/*   NAME                          vChkErr                                  */
/*-- SYNOPSIS --------------------------------------------------------------*/
PRIVATE void
vChkErr(eBOOL cond,		   /* Error-condition to check (TRUE=error) */
	eERRNO err,		   /* Errornumber if error-condition TRUE */
	...			   /* Var. number of args for error-msg. */
)
{
/* DESCRIPTION
 *    Simple error handler.
 *    All errors are fatal (ie cause program termination).
 *    Error messages are written to stderr, and may be redirected to a file.
 *       Alternatively you might want to log error msg directly in an err-file.
 *    Error-messages are "hard coded" into array rgpchErrmsg[], -
 *       In a larger application they would be initialized from a file,
 *       and moved to its own source module together with function vChkErr().
 *-3*/Tue Feb 17 16:51:15 CET 2026
CCITT CRC (REVERSE) for    crc.c   is	[51F3]






END EXTRACTION

